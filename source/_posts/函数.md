---
title: "函数"
date: 2024-05-08
description: ""
cover: https://github.com/Gjt-9520/Resource/blob/main/Bimage-135/Bimage10.png?raw=true
tags: ["MySQL"]
category: "学习笔记"
updated: 2024-05-09
swiper_index: 
top_group_index: 
---

# 函数

函数是指一段可以直接被另一段程序调用的程序或代码

# 字符串函数

![常用字符串函数](../images/SQL-函数-常用字符串函数.png)

`select 函数(参数);`

范例:

```cmd
# concat
select concat('hello', 'mysql');

# lower
select lower('HELLO');

# upper
select upper('mysql');

# lpad
select lpad('00', 5, '-');
# 结果:---00

# rpad
select rpad('00', 5, '-');
# 结果:00---

# trim
select trim('   00 00 00   ');
# 结果:00 00 00

# substring
select substring('hellomysql', 6, 2);
# 结果:my
```

练习:

![范例表](../images/SQL-DQL范例表.png)

下面的练习也以此表为根据

由于业务需求变更,企业员工的工号统一为7位数,目前不足7位数的全部在前面补0,比如1号员工的工号应该为0000001         

```cmd
update emp set workNo=lpad(workNo,7,0);
```

# 数值函数

![常用数值函数](../images/SQL-函数-常用数值函数.png)

范例:

```cmd
# ceil
select ceil(1.4);
# 结果:2
select ceil(-1.4);
# 结果:-1

# floor
select floor(2.7);
# 结果:2
select floor(-2.7);
# 结果:-3

# mod
select mod(6, 4);
# 结果:2

# rand
select rand();

# round
select round(2.345, 2);
# 结果:2.35
select round(2.345, 1);
# 结果:2.3
```

练习:

生成一个6位数的随机验证码

```cmd
select lpad(round(rand() * 1000000, 0), 6, '0');
```

# 日期函数

![常用日期函数](../images/SQL-函数-常用日期函数.png)

细节:**datediff(结束日期,开始日期)函数,返回的天数 = 结束日期 - 开始日期**

范例:

```cmd
# curdate
select curdate();

# curtime
select curtime();

# now
select now();

# year
select year(curdate());

# month
select month(curdate());

# day
select day(curdate());

# date_add
select date_add(now(), interval 70 day);
select date_add(now(), interval 2 month);
select date_add(now(), interval 48 hour);

# datediff
select datediff(now(), date_add(now(), interval -48 hour));
# 结果:2
select datediff('2023-1-1', '2022-1-1');
# 结果:365
```

练习:

查询所有员工的入职天数,并根据入职天数倒序排序

```cmd
select name,datediff(curdate(),entrydate) as workDay from emp order by workDay desc;
```

# 流程函数

流程函数也是很常用的一类函数,可以在SQL语句中实现条件筛选,从而提高语句的效率

![常用流程函数](../images/SQL-函数-常用流程函数.png)

范例:

```cmd
# if
select if(true, '对', '错');
select if(false, '对', '错');

# ifnull
select ifnull('A', 'B');
# 结果:A
select ifnull(null, 'B');
# 结果:B

# case when then else end
# 要求:查询emp表的员工姓名和工作地址(上海/北京 --> 一线城市,其他城市 --> 二线城市)
select name,
       (case workAddress when '北京' then '一线城市' when '上海' then '一线城市' else '二线城市' end) as '工作城市'
from emp;
```

练习:

![学生分数](../images/分数范例表.png)

统计班级各个学生的成绩,展示规则如下:                
1. 大于等于85,展示优秀
2. 大于等于60,展示及格
3. 否则,展示不及格

```cmd
select name as 姓名,
       (case when math >= 85 then '优秀' when math >= 60 then '及格' else '不及格' end) as '数学成绩',
       (case when english >= 85 then '优秀' when english >= 60 then '及格' else '不及格' end) as '英语成绩',
       (case when chinese >= 85 then '优秀' when chinese >= 60 then '及格' else '不及格' end) as '语文成绩'
from score;
```