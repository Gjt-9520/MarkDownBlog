---
title: "苍穹外卖-客户端-商品浏览"
date: 2024-06-30
description: ""
cover: https://github.com/Gjt-9520/Resource/blob/main/Blogimage/project/SkyTakeOut/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-%E5%BA%97%E9%93%BA%E8%90%A5%E4%B8%9A%E7%8A%B6%E6%80%81%E8%AE%BE%E7%BD%AE.png?raw=true
tags: ["SpringBoot","Web"]
category: "项目开发"
updated: 2024-07-01
  
top_group_index: 
---

- [sky-take-out-Gitee仓库](https://gitee.com/gjt_1538048299/sky-take-out)

# 分类浏览

## 需求分析

## 接口设计

## 代码开发

CategoryController.java:

```java
/**
 * 查询分类
 *
 * @param type
 * @return
 */
@GetMapping("/list")
@ApiOperation("查询分类")
public Result<List<Category>> list(Integer type) {
    log.info("查询分类");
    List<Category> list = categoryService.list(type);
    return Result.success(list);
}
```

CategoryService.java:

```java
/**
 * 根据类型查询分类
 *
 * @param type
 * @return
 */
List<Category> list(Integer type);
```

CategoryServiceImpl.java:

```java
/**
 * 根据类型查询分类
 * @param type
 * @return
 */
public List<Category> list(Integer type) {
    return categoryMapper.list(type);
}
```

CategoryMapper.java:

```java
/**
 * 根据类型查询分类
 * @param type
 * @return
 */
List<Category> list(Integer type);
```

CategoryMapper.xml:

```xml
<!--根据类型查询分类-->
<select id="list" resultType="Category">
    select * from category
    where status = 1
    <if test="type != null">
        and type = #{type}
    </if>
    order by sort,create_time desc
</select>
```

# 菜品浏览

## 需求分析

## 接口设计

## 代码开发

DishController.java:

```java
/**
 * 根据分类id查询菜品
 *
 * @param categoryId
 * @return
 */
@GetMapping("/list")
@ApiOperation("根据分类id查询菜品")
public Result<List<DishVO>> list(Long categoryId) {
    log.info("根据分类id查询菜品");
    Dish dish = new Dish();
    dish.setCategoryId(categoryId);
    // 查询起售中的菜品
    dish.setStatus(StatusConstant.ENABLE);

    List<DishVO> list = dishService.listWithFlavor(dish);
    return Result.success(list);
}
```

DishService.java:

```java
/**
 * 条件查询菜品和口味
 * @param dish
 * @return
 */
List<DishVO> listWithFlavor(Dish dish);
```

DishServiceImpl.java:

```java
/**
 * 条件查询菜品和口味
 *
 * @param dish
 * @return
 */
public List<DishVO> listWithFlavor(Dish dish) {
    List<Dish> dishList = dishMapper.list(dish);
    List<DishVO> dishVOList = new ArrayList<>();

    for (Dish d : dishList) {
        DishVO dishVO = new DishVO();
        BeanUtils.copyProperties(d, dishVO);
        // 根据菜品id查询对应的口味
        List<DishFlavor> flavors = dishFlavorMapper.getByDishId(d.getId());
        dishVO.setFlavors(flavors);
        dishVOList.add(dishVO);
    }
    return dishVOList;
}
```

DishMapper.xml:

```xml
<!--根据分类id查询菜品-->
<select id="list" resultType="com.sky.entity.Dish">
    select *
    from dish
    <where>
        <if test="name!=null">
            and name like concat('%',#{name},'%')
        </if>
        <if test="categoryId!=null">
            and category_id=#{categoryId}
        </if>
        <if test="status!=null">
            and status=#{status}
        </if>
    </where>
    order by create_time desc
</select>
```

# 套餐浏览

## 根据分类id查询套餐

### 需求分析

### 接口设计

### 代码开发

SetmealController.java:

```java
@RestController("userSetmealController")
@RequestMapping("/user/setmeal")
@Api(tags = "套餐浏览接口")
@Slf4j
public class SetmealController {
    @Autowired
    private SetmealService setmealService;

    /**
     * 根据分类id查询套餐
     *
     * @param categoryId
     * @return
     */
    @GetMapping("/list")
    @ApiOperation("根据分类id查询套餐")
    public Result<List<Setmeal>> list(Long categoryId) {
        log.info("根据分类id查询套餐");
        Setmeal setmeal = new Setmeal();
        setmeal.setCategoryId(categoryId);
        setmeal.setStatus(StatusConstant.ENABLE);

        List<Setmeal> list = setmealService.list(setmeal);
        return Result.success(list);
    }
}
```

SetmealService.java:

```java
/**
 * 根据分类id查询套餐
 *
 * @param setmeal
 * @return
 */
List<Setmeal> list(Setmeal setmeal);
```

SetmealServiceImpl.java:

```java
/**
 * 根据分类id查询套餐
 *
 * @param setmeal
 * @return
 */
@Override
public List<Setmeal> list(Setmeal setmeal) {
    return setmealMapper.list(setmeal);
}
```

SetmealMapper.java:

```java
/**
 * 根据分类id查询套餐
 *
 * @param setmeal
 * @return
 */
List<Setmeal> list(Setmeal setmeal);
```

SetmealMapper.xml:

```xml
<select id="list" parameterType="Setmeal" resultType="Setmeal">
    select * from setmeal
    <where>
        <if test="name != null">
            and name like concat('%',#{name},'%')
        </if>
        <if test="categoryId != null">
            and category_id = #{categoryId}
        </if>
        <if test="status != null">
            and status = #{status}
        </if>
    </where>
</select>
```

## 根据套餐id查询包含的菜品

### 需求分析

### 接口设计

### 代码开发

SetmealController.java:

```java
/**
 * 根据套餐id查询包含的菜品列表
 *
 * @param id
 * @return
 */
@GetMapping("/dish/{id}")
@ApiOperation("根据套餐id查询包含的菜品列表")
public Result<List<DishItemVO>> dishList(@PathVariable("id") Long id) {
    log.info("根据套餐id查询包含的菜品列表");
    List<DishItemVO> list = setmealService.getDishItemById(id);
    return Result.success(list);
}
```

SetmealService.java:

```java
/**
 * 根据套餐id查询包含的菜品列表
 * @param id
 * @return
 */
List<DishItemVO> getDishItemById(Long id);
```

SetmealServiceImpl.java:

```java
/**
 * 根据套餐id查询包含的菜品列表
 * @param id
 * @return
 */
public List<DishItemVO> getDishItemById(Long id) {
    return setmealMapper.getDishItemBySetmealId(id);
}
```

SetmealMapper.java:

```java
/**
 * 根据套餐id查询包含的菜品列表
 *
 * @param setmealId
 * @return
 */
@Select("select sd.name, sd.copies, d.image, d.description " +
        "from setmeal_dish sd left join dish d on sd.dish_id = d.id " +
        "where sd.setmeal_id = #{setmealId}")
List<DishItemVO> getDishItemBySetmealId(Long setmealId);
```